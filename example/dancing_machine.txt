$0 = $in

loop
  $1 = $0 >> 1
  $0 = $0 ^ $1
  $1 = $0 << 1
  $0 = $0 ^ $1
  $1 = $0 >> 2
  $0 = $0 ^ $1
  $out = $0 & 3
done